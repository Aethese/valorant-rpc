<!DOCTYPE html>
<html>

    <body id="text" onload="check_localhost()">
        redirecting...
        <script>
        function check_localhost(){
            var urlParams = new URLSearchParams(window.location.search);
            var target = urlParams.get('redir')
            var region = urlParams.get('region')
            console.log(region)
            console.log(target)
            
            var local_url = 'http://127.0.0.1:4100';
            var http = new XMLHttpRequest();

            http.open('GET', local_url, true);
            http.send();
            http.onreadystatechange = function () {
                if (http.readyState == 4 && http.status == 200) {
                    var location = local_url
                    if(location != null){
                        location = location + target
                    }
                    if(region != null){
                        location = location + "?region=" + region
                    }
                    document.getElementById("text").innerHTML = "redirecting to <a href="+location+">"+location+"</>";
                    window.location.replace(location);
                }else if (http.readyState == 4){
                    var github_location = "https://github.com/colinhartigan/valorant-rpc"
                    document.getElementById("text").innerHTML = "redirecting to <a href="+github_location+">"+github_location+"</>";
                    window.location.replace(github_location);
                }
            };
            
        }
        </script>
    
    </body>

</html> 