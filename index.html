<!DOCTYPE html>
<html>

    <body id="text" onload="check_localhost()">
        redirecting...
        <script>
        function check_localhost(){
            var urlParams = new URLSearchParams(window.location.search);
            var target = urlParams.get('redir')
            var region = urlParams.get('region')
            console.log(region)
            
            var local_url = 'http://127.0.0.1:4100';
            var http = new XMLHttpRequest();

            http.open('GET', local_url, true);
            http.send();
            http.onreadystatechange = function () {
                if (http.readyState == 4 && http.status == 200) {
                    location = "http://127.0.0.1:4100"+target
                    if(region != null){
                        location = location + "?region=" + region
                    }
                    document.getElementById("text").innerHTML = "redirecting to <a href="+location+">"+location+"</>";
                    window.location.replace(location);
                }else if (http.readyState == 4){
                    window.location.replace("https://github.com/colinhartigan/valorant-rpc");
                }
            };
            
        }
        </script>
    
    </body>

</html> 